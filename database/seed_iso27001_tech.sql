-- ISO/IEC 27001:2022 Technological Controls (A.8) Seed Data

-- A.8 Technological Controls (34 controls)
INSERT INTO framework_requirements (framework_id, domain_id, code, name, description, guidance, evidence_requirements, evidence_examples)
VALUES

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.1',
'User Endpoint Devices',
'Information stored on, processed by or accessible via user endpoint devices shall be protected.',
'Implement endpoint security controls.',
'Endpoint security configurations, MDM policies, device encryption.',
ARRAY['Endpoint Security Policy', 'MDM configurations', 'Device encryption evidence', 'Endpoint protection configurations']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.2',
'Privileged Access Rights',
'The allocation and use of privileged access rights shall be restricted and managed.',
'Manage privileged access rights.',
'PAM configurations, privileged access procedures, access reviews.',
ARRAY['Privileged Access Policy', 'PAM configurations', 'Privileged account inventory', 'Privileged access reviews']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.3',
'Information Access Restriction',
'Access to information and application system functions shall be restricted in accordance with the access control policy.',
'Restrict access to information and systems.',
'Access restrictions, RBAC configurations, access controls.',
ARRAY['Access restriction configurations', 'RBAC matrix', 'Application access controls', 'Information access logs']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.4',
'Access to Source Code',
'Read and write access to source code, development tools and software libraries shall be appropriately managed.',
'Control access to source code.',
'Source code access controls, repository permissions, code review procedures.',
ARRAY['Source code access policy', 'Repository permission settings', 'Code review procedures', 'Development access controls']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.5',
'Secure Authentication',
'Secure authentication technologies and procedures shall be implemented based on information access restrictions and the access control policy.',
'Implement secure authentication.',
'Authentication configurations, MFA implementation, authentication policies.',
ARRAY['Authentication Policy', 'MFA configurations', 'SSO configurations', 'Authentication logs']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.6',
'Capacity Management',
'The use of resources shall be monitored and adjusted in line with current and expected capacity requirements.',
'Monitor and manage system capacity.',
'Capacity monitoring, capacity planning, resource utilization reports.',
ARRAY['Capacity monitoring dashboards', 'Capacity planning documents', 'Resource utilization reports', 'Scaling configurations']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.7',
'Protection Against Malware',
'Protection against malware shall be implemented and supported by appropriate user awareness.',
'Implement malware protection.',
'Antivirus/EDR configurations, malware scan reports, awareness training.',
ARRAY['Antivirus/EDR configurations', 'Malware scan reports', 'Malware awareness training', 'Threat detection logs']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.8',
'Management of Technical Vulnerabilities',
'Information about technical vulnerabilities of information systems in use shall be obtained, the organization exposure to such vulnerabilities shall be evaluated and appropriate measures shall be taken.',
'Manage technical vulnerabilities.',
'Vulnerability scanning, patch management, vulnerability remediation.',
ARRAY['Vulnerability scan reports', 'Patch management records', 'Vulnerability remediation tracking', 'CVE monitoring evidence']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.9',
'Configuration Management',
'Configurations, including security configurations, of hardware, software, services and networks shall be established, documented, implemented, monitored and reviewed.',
'Manage system configurations.',
'Configuration standards, baseline configurations, configuration change tracking.',
ARRAY['Configuration management policy', 'Baseline configurations', 'Configuration change records', 'Security hardening guides']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.10',
'Information Deletion',
'Information stored in information systems, devices or in any other storage media shall be deleted when no longer required.',
'Delete information when no longer needed.',
'Data retention schedules, deletion procedures, deletion verification.',
ARRAY['Data Retention Policy', 'Deletion procedures', 'Deletion verification records', 'Data lifecycle documentation']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.11',
'Data Masking',
'Data masking shall be used in accordance with the organization topic-specific policy on access control and other related topic-specific policies, and business requirements, taking applicable legislation into consideration.',
'Implement data masking.',
'Data masking policies, masking configurations, masked data examples.',
ARRAY['Data Masking Policy', 'Masking configurations', 'Masked data samples', 'Masking implementation evidence']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.12',
'Data Leakage Prevention',
'Data leakage prevention measures shall be applied to systems, networks and any other devices that process, store or transmit sensitive information.',
'Implement DLP controls.',
'DLP policies, DLP configurations, DLP incident reports.',
ARRAY['DLP Policy', 'DLP tool configurations', 'DLP alerts/incidents', 'Data flow analysis']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.13',
'Information Backup',
'Backup copies of information, software and systems shall be maintained and regularly tested in accordance with the agreed topic-specific policy on backup.',
'Implement backup procedures.',
'Backup policies, backup schedules, backup testing, restore testing.',
ARRAY['Backup Policy', 'Backup schedules', 'Backup completion logs', 'Restore test results']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.14',
'Redundancy of Information Processing Facilities',
'Information processing facilities shall be implemented with redundancy sufficient to meet availability requirements.',
'Implement system redundancy.',
'Redundancy architecture, failover configurations, redundancy testing.',
ARRAY['Redundancy architecture documentation', 'High availability configurations', 'Failover test results', 'Redundancy monitoring']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.15',
'Logging',
'Logs that record activities, exceptions, faults and other relevant events shall be produced, stored, protected and analysed.',
'Implement comprehensive logging.',
'Logging policies, log configurations, log retention, log analysis.',
ARRAY['Logging Policy', 'Log configurations', 'Log retention evidence', 'Log analysis procedures', 'SIEM configurations']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.16',
'Monitoring Activities',
'Networks, systems and applications shall be monitored for anomalous behaviour and appropriate actions taken to evaluate potential information security incidents.',
'Implement security monitoring.',
'Monitoring configurations, alerting rules, monitoring dashboards.',
ARRAY['Security monitoring procedures', 'Monitoring dashboards', 'Alert configurations', 'Anomaly detection rules', 'Monitoring reports']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.17',
'Clock Synchronization',
'The clocks of information processing systems used by the organization shall be synchronized to approved time sources.',
'Synchronize system clocks.',
'NTP configurations, time synchronization evidence.',
ARRAY['NTP configurations', 'Time synchronization logs', 'Time source documentation', 'Clock sync monitoring']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.18',
'Use of Privileged Utility Programs',
'The use of utility programs that might be capable of overriding system and application controls shall be restricted and tightly controlled.',
'Control privileged utilities.',
'Utility program inventory, access restrictions, usage logging.',
ARRAY['Privileged utility inventory', 'Access restrictions', 'Utility usage logs', 'Control procedures']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.19',
'Installation of Software on Operational Systems',
'Procedures and measures shall be implemented to securely manage software installation on operational systems.',
'Control software installation.',
'Software installation procedures, approval processes, installation logs.',
ARRAY['Software Installation Policy', 'Approval procedures', 'Installation logs', 'Authorized software list']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.20',
'Networks Security',
'Networks and network devices shall be secured, managed and controlled to protect information in systems and applications.',
'Secure network infrastructure.',
'Network security configurations, network diagrams, network controls.',
ARRAY['Network Security Policy', 'Network architecture diagrams', 'Network device configurations', 'Network security controls']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.21',
'Security of Network Services',
'Security mechanisms, service levels and service requirements of network services shall be identified, implemented and monitored.',
'Secure network services.',
'Network service security requirements, SLAs, service monitoring.',
ARRAY['Network service SLAs', 'Security requirements', 'Service monitoring evidence', 'Network service inventory']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.22',
'Segregation of Networks',
'Groups of information services, users and information systems shall be segregated in the organization networks.',
'Implement network segmentation.',
'Network segmentation diagrams, VLAN configurations, firewall rules.',
ARRAY['Network segmentation documentation', 'VLAN configurations', 'Firewall rules', 'Segmentation testing results']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.23',
'Web Filtering',
'Access to external websites shall be managed to reduce exposure to malicious content.',
'Implement web filtering.',
'Web filter policies, blocked category lists, filter logs.',
ARRAY['Web Filtering Policy', 'Category blocking configurations', 'Web filter logs', 'Exception procedures']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.24',
'Use of Cryptography',
'Rules for the effective use of cryptography, including cryptographic key management, shall be defined and implemented.',
'Implement cryptographic controls.',
'Cryptography policy, encryption standards, key management procedures.',
ARRAY['Cryptography Policy', 'Encryption standards', 'Key management procedures', 'Certificate inventory']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.25',
'Secure Development Life Cycle',
'Rules for the secure development of software and systems shall be established and applied.',
'Implement secure SDLC.',
'SDLC procedures, security requirements, code review processes.',
ARRAY['Secure SDLC Policy', 'Security requirements', 'Code review procedures', 'Security testing evidence']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.26',
'Application Security Requirements',
'Information security requirements shall be identified, specified and approved when developing or acquiring applications.',
'Define application security requirements.',
'Security requirements documentation, requirement specifications.',
ARRAY['Application security requirements', 'Security specifications', 'Requirement sign-offs', 'Security design documentation']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.27',
'Secure System Architecture and Engineering Principles',
'Principles for engineering secure systems shall be established, documented, maintained and applied to any information system development activities.',
'Apply secure architecture principles.',
'Architecture standards, security design principles, reference architectures.',
ARRAY['Security architecture standards', 'Design principles documentation', 'Reference architectures', 'Architecture reviews']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.28',
'Secure Coding',
'Secure coding principles shall be applied to software development.',
'Implement secure coding practices.',
'Coding standards, code review evidence, static analysis.',
ARRAY['Secure Coding Standards', 'Code review records', 'SAST scan results', 'Coding guidelines']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.29',
'Security Testing in Development and Acceptance',
'Security testing processes shall be defined and implemented in the development life cycle.',
'Implement security testing.',
'Security testing procedures, test results, penetration test reports.',
ARRAY['Security testing procedures', 'DAST scan results', 'Penetration test reports', 'Security test cases']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.30',
'Outsourced Development',
'The organization shall direct, monitor and review the activities related to outsourced system development.',
'Manage outsourced development security.',
'Outsourcing agreements, security requirements, review procedures.',
ARRAY['Outsourcing security requirements', 'Vendor development agreements', 'Code review of outsourced code', 'Vendor security assessments']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.31',
'Separation of Development, Test and Production Environments',
'Development, testing and production environments shall be separated and secured.',
'Separate environments appropriately.',
'Environment separation documentation, access controls, data handling.',
ARRAY['Environment separation documentation', 'Environment access controls', 'Test data procedures', 'Deployment procedures']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.32',
'Change Management',
'Changes to information processing facilities and information systems shall be subject to change management procedures.',
'Implement change management.',
'Change management policy, change tickets, approval evidence.',
ARRAY['Change Management Policy', 'Change tickets', 'CAB meeting records', 'Change approval evidence']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.33',
'Test Information',
'Test information shall be appropriately selected, protected and managed.',
'Protect test data.',
'Test data procedures, data anonymization, test data controls.',
ARRAY['Test Data Policy', 'Data anonymization procedures', 'Test data protection evidence', 'Production data restrictions']),

('f0000002-0000-0000-0000-000000000001', 'd0002004-0000-0000-0000-000000000001', 'A.8.34',
'Protection of Information Systems During Audit Testing',
'Audit tests and other assurance activities involving assessment of operational systems shall be planned and agreed between the tester and appropriate management.',
'Manage audit testing safely.',
'Audit planning, testing agreements, testing safeguards.',
ARRAY['Audit testing procedures', 'Testing agreements', 'Audit safeguards', 'Testing schedules'])

ON CONFLICT (framework_id, code) DO UPDATE SET
    description = EXCLUDED.description,
    guidance = EXCLUDED.guidance,
    evidence_requirements = EXCLUDED.evidence_requirements,
    evidence_examples = EXCLUDED.evidence_examples;
